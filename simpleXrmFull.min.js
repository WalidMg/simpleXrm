var simpleXrm={error:function(n,t){t&&simpleXrm.timedFormError(t,3e3);console.log("Error originating in a script using the simpleXrm.js library. Contact your CRM Administrator with the following details: Element "+n.toString()+" was not found or is invalid.")},getAttDate:function(n){var t=simpleXrm.getAttVal(n);return{year:t.getFullYear(),month:t.getMonth(),date:t.getDate(),hours:t.getHours(),minutes:t.getMinutes()}||null},parseDuration:function(n){return x=n*6e4||null},parseDate:function(n){return x=new Date(n.year,n.month,n.date,n.hours,n.minutes).getTime()||null},offsetTime:function(n,t){var i=simpleXrm.getAttVal(n)||null,r=i.getFullYear()||null,u=i.getMonth()||null,f=i.getDate()||null,e=i.getHours()||null,o=i.getMinutes()||null;return new Date(r,u,f,e+t,o)||null},valid:function(n){return n!=null&&n!=undefined},doesNotContainData:function(n){return!Xrm.Page.getAttribute(n).getValue()},containsData:function(n){return simpleXrm.valid(Xrm.Page.getAttribute(n).getValue())||!1},validAtt:function(n){return n&&Xrm.Page.getAttribute(n)||!1},getCurrentId:function(){return Xrm.Page.data.entity.getId()},getCurrentEntityName:function(){return Xrm.Page.data.entity.getEntityName()},getAtt:function(n){return Xrm.Page.getAttribute(n)},getAttType:function(n){return Xrm.Page.getAttribute(n).getAttributeType()},getAttVal:function(n){return Xrm.Page.getAttribute(n).getValue()},hasVal:function(n){return simpleXrm.valid(Xrm.Page.getAttribute(n).getValue())||!1},getLookupVal:function(n){return simpleXrm.getAttVal(n)?Xrm.Page.getAttribute(n).getValue()[0].name:null},getLookupID:function(n){return simpleXrm.getAttVal(n)?Xrm.Page.getAttribute(n).getValue()[0].id:null},getLookupEntityName:function(n){return simpleXrm.getAttVal(n)?Xrm.Page.getAttribute(n).getValue()[0].entityType:null},setAttVal:function(n,t){try{Xrm.Page.getAttribute(n).setValue(t)}catch(i){simpleXrm.error(n,"Could not set the value of attribute "+n+" to value "+t.toString()+".")}},clearAttVal:function(n){Xrm.Page.getAttribute(n.toString()).setValue(null);simpleXrm.sendAttAlways(n.toString())},clearAttsVal:function(){for(var n=0;n<arguments.length;n++)simpleXrm.clearAttVal(arguments[n])},sendAttAlways:function(n){simpleXrm.getAtt(n).setSubmitMode("always")},sendAttsAlways:function(){for(var n=0;n<arguments.length;n++)simpleXrm.sendAttAlways(arguments[n])},sendAttNever:function(n){simpleXrm.getAtt(n).setSubmitMode("never")},sendAttsNever:function(){for(var n=0;n<arguments.length;n++)simpleXrm.sendAttNever(arguments[n])},sendAttChanges:function(n){simpleXrm.getAtt(n).setSubmitMode("dirty")},sendAttsChanges:function(){for(var n=0;n<arguments.length;n++)simpleXrm.sendAttChanges(arguments[n])},getAttReqd:function(n){return simpleXrm.getAtt(n).getRequiredLevel()},setAttReqd:function(n){simpleXrm.getAtt(n).setRequiredLevel("required")},setAttsReqd:function(){for(var n=0;n<arguments.length;n++)simpleXrm.setAttReqd(arguments[n])},clearAttReqd:function(n){simpleXrm.getAtt(n).setRequiredLevel("none")},clearAttsReqd:function(){for(var n=0;n<arguments.length;n++)simpleXrm.clearAttReqd(arguments[n])},setAttRecommended:function(n){simpleXrm.getAtt(n).setRequiredLevel("recommended")},setAttsRecommended:function(){for(var n=0;n<arguments.length;n++)simpleXrm.setAttRecommended(arguments[n])},fireOnChange:function(n){simpleXrm.getAtt(n).fireOnChange()},fireChanges:function(){for(var n=0;n<arguments.length;n++)simpleXrm.fireOnChange(arguments[n])},validCtrl:function(n){return simpleXrm.valid(Xrm.Page.getControl(n))||!1},getCtrl:function(n){return Xrm.Page.getControl(n)},getAllCtrls:function(n){return simpleXrm.getAtt(n).controls},showCtrl:function(n){simpleXrm.getCtrl(n).setVisible(!0)},showCtrls:function(){for(var n=0;n<arguments.length;n++)simpleXrm.showCtrl(arguments[n])},hideCtrl:function(n){simpleXrm.getCtrl(n).setVisible(!1)},hideCtrls:function(){for(var n=0;n<arguments.length;n++)simpleXrm.hideCtrl(arguments[n])},clearOptions:function(n){simpleXrm.getAllCtrls(n).forEach(function(n){n.clearOptions()})},restoreOptions:function(n){simpleXrm.clearOptions(n);simpleXrm.getAllCtrls(n).forEach(function(t){simpleXrm.getAtt(n).getOptions().forEach(function(n){t.addOption(n)})})},removeOption:function(n,t){simpleXrm.getAllCtrls(n).forEach(function(n){n.removeOption(t)})},showAllCtrls:function(n){simpleXrm.getAllCtrls(n).forEach(function(n){n.setVisible(!0)})},hideAllCtrls:function(n){simpleXrm.getAllCtrls(n).forEach(function(n){n.setVisible(!1)})},lockCtrl:function(n){simpleXrm.getCtrl(n).setDisabled(!0)},lockCtrls:function(){for(var n=0;n<arguments.length;n++)simpleXrm.lockCtrl(arguments[n])},unlockCtrl:function(n){simpleXrm.getCtrl(n).setDisabled(!1)},unlockCtrls:function(){for(var n=0;n<arguments.length;n++)simpleXrm.unlockCtrl(arguments[n])},lockAllCtrls:function(n){simpleXrm.getAllCtrls(n).forEach(function(n){n.setDisabled(!0)})},unlockAllCtrls:function(n){simpleXrm.getAllCtrls(n).forEach(function(n){n.setDisabled(!1)})},relabelCtrl:function(n,t){simpleXrm.getCtrl(n).setLabel(t)},relabelAllCtrls:function(n,t){simpleXrm.getAllCtrls(n).forEach(function(n){n.setLabel(t)})},allTabs:function(){return Xrm.Page.ui.tabs},validTab:function(n){return!!simpleXrm.allTabs().get(n)||!1},getTab:function(n){return simpleXrm.allTabs().get(n.toString())},showTab:function(n){simpleXrm.getTab(n).setVisible(!0)},showTabs:function(){for(var n=0;n<arguments.length;n++)simpleXrm.showTab(arguments[n])},hideTab:function(n){simpleXrm.getTab(n).setVisible(!1)},hideTabs:function(){for(var n=0;n<arguments.length;n++)simpleXrm.hideTab(arguments[n])},validSection:function(n){var t=!1;return simpleXrm.allTabs().forEach(function(i){!i.sections.get(n.toString())||(t=!0)}),t},getSection:function(n){var t=null;return simpleXrm.allTabs().forEach(function(i){simpleXrm.valid(i.sections.get(n.toString()))&&(t=i.sections.get(n.toString()))}),t},showSection:function(n){simpleXrm.getSection(n).setVisible(!0)},showSections:function(){for(var n=0;n<arguments.length;n++)simpleXrm.showSection(arguments[n])},hideSection:function(n){simpleXrm.getSection(n).setVisible(!1)},hideSections:function(){for(var n=0;n<arguments.length;n++)simpleXrm.hideSection(arguments[n])},closeAtt:function(n){simpleXrm.hideAllCtrls(n);simpleXrm.clearAttReqd(n);simpleXrm.clearAttVal(n);simpleXrm.lockAllCtrls(n);simpleXrm.sendAttChanges(n)},closeAtts:function(){for(var n=0;n<arguments.length;n++)simpleXrm.closeAtt(arguments[n])},openAtt:function(n){simpleXrm.unlockAllCtrls(n);simpleXrm.showAllCtrls(n);simpleXrm.sendAttChanges(n)},openAtts:function(){for(var n=0;n<arguments.length;n++)simpleXrm.openAtt(arguments[n])},sumAtts:function(){for(var t=0,n=0;n<arguments.length;n++)isNaN(simpleXrm.getAttVal(arguments[n]))||(t+=simpleXrm.getAttVal(arguments[n]));return t},calculatePercent:function(n,t){return n/t*100},link:function(n,t){return n.length===1?n[0].toString():n.join(t)},cleanGuid:function(n){var t=n;try{t=t.replace("{","")}catch(i){}try{t=t.replace("}","")}catch(i){}return t},wrapGuid:function(n){return"{"+simpleXrm.cleanGuid(n)+"}"},newGuid:function(){function n(){return((1+Math.random())*65536|0).toString(16).substring(1)}return(n()+n()+"-"+n()+"-4"+n().substr(0,3)+"-"+n()+"-"+n()+n()+n()).toString().toUpperCase()},newBracedGuid:function(){return simpleXrm.wrapGuid(simpleXrm.newGuid())},timeStamp:function(n,i){if(t=Xrm.Page.getAttribute(n).getValue(),t===null||i===!0||i===undefined){var r=new Date;Xrm.Page.getAttribute(n).setValue(r);Xrm.Page.getAttribute(n).setSubmitMode("dirty")}},parseRESTLookup:function(n){try{return[{entityType:n.LogicalName,id:simpleXrm.wrapGuid(n.Id),name:n.Name}]}catch(i){return null}},setLookupVal:function(n,t,i){var u=t||null,r=!0;i===!1&&(r=!1);r&&simpleXrm.setAttVal(n,u)},setBooleanDefault:function(n){simpleXrm.getAttVal(n)||simpleXrm.setAttVal(n,!1)},setBooleanDefaults:function(){for(var n=0;n<arguments.length;n++)simpleXrm.setBooleanDefault(arguments[n])},applyFilter:function(n){simpleXrm.getCtrl(n).addPreSearch(function(t){simpleXrm.getCtrl(n).addCustomFilter(t)})},closeSection:function(n){simpleXrm.hideSection(n);simpleXrm.getSection(n).controls.forEach(function(n){n.getAttribute().setValue(null);n.getAttribute().setSubmitMode("dirty");n.setRequiredLevel("none");n.setDisabled(!0)})},closeSections:function(){for(var n=0;n<arguments.length;n++)simpleXrm.closeSection(arguments[n])},openSection:function(n){simpleXrm.showSection(n);simpleXrm.getSection(n).controls.forEach(function(n){n.setDisabled(!1);n.setVisible(!0)})},openSections:function(){for(var n=0;n<arguments.length;n++)simpleXrm.openSection(arguments[n])},closeTab:function(n){simpleXrm.hideTab(n);simpleXrm.getTab(n).sections.forEach(function(n){n.controls.forEach(function(n){n.getAttribute().setValue(null)})})},closeTabs:function(){for(var n=0;n<arguments.length;n++)simpleXrm.closeTab(arguments[n])},formatPhoneNumber:function(n){var i=n.getEventSource(),r=function(n){for(var i,t,u="",r=0;r<n.length;r++){i=n.charAt(r).toUpperCase();t=i;switch(i){case"A":case"B":case"C":t=2;break;case"D":case"E":case"F":t=3;break;case"G":case"H":case"I":t=4;break;case"J":case"K":case"L":t=5;break;case"M":case"N":case"O":t=6;break;case"P":case"Q":case"R":case"S":t=7;break;case"T":case"U":case"V":t=8;break;case"W":case"X":case"Y":case"Z":t=9;break;default:t=i}u+=t}return u},t;if(simpleXrm.valid(i)&&i.getValue()!=null){t=i.getValue().replace(/[^0-9,A-Z,a-z]/g,"");try{t=t.length<=10?r(t):r(t.substr(0,10))+t.substr(10,t.length)}catch(u){}switch(t.length){case 1:case 2:case 3:case 4:case 5:case 6:case 8:case 9:break;case 7:i.setValue(t.substr(0,3)+"-"+t.substr(3,4));break;case 10:i.setValue("("+t.substr(0,3)+") "+t.substr(3,3)+"-"+t.substr(6,4));break;default:i.setValue("("+t.substr(0,3)+") "+t.substr(3,3)+"-"+t.substr(6,4)+" "+t.substr(10,t.length))}}},refresh:function(n){Xrm.Page.data.refresh(n)},setFormWarning:function(n,t){Xrm.Page.ui.setFormNotification(n,"WARNING",t)},setFormError:function(n,t){Xrm.Page.ui.setFormNotification(n,"ERROR",t)},setFormInfo:function(n,t){Xrm.Page.ui.setFormNotification(n,"INFO",t)},clearFormNotification:function(n){try{Xrm.Page.ui.clearFormNotification(n)}catch(t){}},setFieldWarning:function(n,t,i){simpleXrm.getCtrl(n).setNotification(t,i)},clearFieldWarning:function(n,t){try{simpleXrm.getCtrl(n).clearNotification(t)}catch(i){console.log("Could not clear form notification with ID "+t+".")}},timedFormError:function(n,t){var i=simpleXrm.newGuid();simpleXrm.setFormError(n,i);setTimeout(function(){simpleXrm.clearFormNotification(i)},t)},timedFormWarning:function(n,t){var i=simpleXrm.newGuid();simpleXrm.setFormWarning(n,i);setTimeout(function(){simpleXrm.clearFormNotification(i)},t)},timedFormInfo:function(n,t){var i=simpleXrm.newGuid();simpleXrm.setFormInfo(n,i);setTimeout(function(){simpleXrm.clearFormNotification(i)},t)},confirmPopUp:function(n,t,i){Xrm.Utility.confirmDialog(n,t,i)},calc2Fields:function(n,t,i){var u=simpleXrm.getAttVal(n),f=simpleXrm.getAttVal(t),r=i||100;simpleXrm.valid(u)?u<=r&&u>=0?simpleXrm.setAttVal(t,r-u):u>r&&(simpleXrm.setAttVal(n,r),simpleXrm.setAttVal(t,0)):simpleXrm.valid(f)&&(f<=r&&f>=0?simpleXrm.setAttVal(n,s-f):f>r&&simpleXrm.setAttVal(t,r))},calc3Fields:function(n,t,i,r){var u=simpleXrm.getAttVal(n),e=simpleXrm.getAttVal(t),o=simpleXrm.getAttVal(i),f=r||100;simpleXrm.valid(u)||simpleXrm.setAttVal(n,0);simpleXrm.valid(e)||simpleXrm.setAttVal(t,0);simpleXrm.valid(o)||simpleXrm.setAttVal(i,0);u>=f?(simpleXrm.setAttVal(n,f),simpleXrm.setAttVal(t,0),simpleXrm.setAttVal(i,0)):u<f&&u>=0&&e<=f&&e>=0&&u+e>f?(simpleXrm.setAttVal(t,f-u),simpleXrm.setAttVal(i,0)):u<=f&&u>=0&&e<=f&&e>=0&&u+e<=f&&simpleXrm.setAttVal(i,f-(u+e))},calc4Fields:function(n,t,i,r,u){var e=simpleXrm.getAttVal(n),o=simpleXrm.getAttVal(t),s=simpleXrm.getAttVal(i),h=simpleXrm.getAttVal(r),f=u||100;simpleXrm.valid(e)||simpleXrm.setAttVal(n,0);simpleXrm.valid(o)||simpleXrm.setAttVal(t,0);simpleXrm.valid(s)||simpleXrm.setAttVal(i,0);simpleXrm.valid(h)||simpleXrm.setAttVal(r,0);e>=f?(simpleXrm.setAttVal(n,f),simpleXrm.setAttVal(t,0),simpleXrm.setAttVal(i,0),simpleXrm.setAttVal(r,0)):e<f&&e>=0&&o<=f&&o>=0&&e+o>f?(simpleXrm.setAttVal(t,f-e),simpleXrm.setAttVal(i,0),simpleXrm.setAttVal(r,0)):e<f&&e>=0&&o<=f&&o>=0&&e+o<=f&&f==0?(simpleXrm.setAttVal(i,f-(e+o)),simpleXrm.setAttVal(r,0)):e<f&&e>=0&&o<=f&&o>=0&&s<=f&&s>=0&&e+o+s<=f&&simpleXrm.setAttVal(r,f-(e+o+s))},getSaveMode:function(n){return n.getEventArgs().getSaveMode()},preventDefault:function(n){n.getEventArgs().preventDefault()},refresh:function(n){n?Xrm.Page.data.refresh(!0).then(simpleXrm.timedFormInfo("The form is being saved...",2e3)):Xrm.Page.data.refresh(!1)},backgroundSave:function(){Xrm.Page.data.save().then(simpleXrm.timedFormInfo("The form is being saved...",2e3))},parseValue:function(n){return n&&(typeof n=="object"&&n.Value?n=n.Value:typeof n=="object"&&(n=null),typeof n=="string"&&(n=parseFloat(n))),n||null}},simpleXrmRest={fakeIt:function(){window.JSON||(console.log("It is not 1991 anymore. Please retire your Apple II or CalecoVision and use a browser that supports JSON."),window.JSON={parse:function(sJSON){return eval("("+sJSON+")")},stringify:function(n){var t,i,r;if(n instanceof Object){if(t="",n.constructor===Array){for(i=0;i<n.length;t+=this.stringify(n[i])+",",i++);return"["+t.substr(0,t.length-1)+"]"}if(n.toString!==Object.prototype.toString)return'"'+n.toString().replace(/"/g,"\\$&")+'"';for(r in n)t+='"'+r.replace(/"/g,"\\$&")+'":'+this.stringify(n[r])+",";return"{"+t.substr(0,t.length-1)+"}"}return typeof n=="string"?'"'+n.replace(/"/g,"\\$&")+'"':String(n)}});simpleXrm.timedFormWarning("It is not 1991 anymore. Please retire your Apple II or CalecoVision and use a browser that supports JSON.",3e3,"ShameOnYou")},parseDate:function(n,t){var i;return typeof t=="string"&&(i=/Date\(([-+]?\d+)\)/.exec(t),i)?new Date(parseInt(t.replace("/Date(","").replace(")/",""),10)):t},XHR:function(n){var t=Xrm.Page.context.getClientUrl();if(simpleXrm.valid(t)){if(t+="/XRMServices/2011/OrganizationData.svc/"+n.query.toString(),window.XMLHttpRequest)XHR=new XMLHttpRequest;else if(window.ActiveXObject)XHR=new ActiveXObject("Microsoft.XMLHTTP");else return simpleXrm.error("We encountered an unexpected issue. Please check your form data before proceeding. Info for Admin: User's browser may not support one of the requested scripts. Please attempt using FireFox or IE 8+"),null;XHR.open("GET",encodeURI(t),!1);XHR.setRequestHeader("Accept","application/json");XHR.setRequestHeader("Content-Type","application/json; charset=utf-8");XHR.onreadystatechange=n.callback;XHR.send()}},query:function(n){simpleXrmRest.XHR({query:simpleXrmRest.buildQuery({entitySet:n.entitySet,select:simpleXrmRest.select(n.select),filter:simpleXrmRest.filter(n.filter),orderBy:simpleXrmRest.orderBy(n.orderBy),expand:simpleXrmRest.expand(n.expand),skip:simpleXrmRest.skip(n.skip),top:simpleXrmRest.top(n.top)}),callback:n.callback})},mapResults:function(n){var i=n.map,t=n.results;for(x in i)!t[x]||(typeof t[x]=="object"?t[x].Value?simpleXrm.setAttVal(i[x],t[x].Value):!t[x].Id||!t[x].Name?simpleXrm.clearAttVal(i[x]):simpleXrm.setAttVal(i[x],simpleXrm.parseRESTLookup(t[x])):simpleXrm.setAttVal(i[x],t[x]))},buildQuery:function(n){var t="",o=n.entitySet,i=n.select,r=n.filter,u=n.orderBy,f=n.expand,e=n.skip,s=n.top;return simpleXrm.valid(o)&&(t+=o.toString()+"?"),simpleXrm.valid(i)&&(t+=i.toString()),simpleXrm.valid(r)&&(simpleXrm.valid(i)&&(t+="&"),t+=r.toString()),simpleXrm.valid(u)&&((simpleXrm.valid(i)||simpleXrm.valid(r))&&(t+="&"),t+=u.toString()),simpleXrm.valid(f)&&((simpleXrm.valid(i)||simpleXrm.valid(r)||simpleXrm.valid(u))&&(t+="&"),t+=f.toString()),simpleXrm.valid(e)&&((simpleXrm.valid(i)||simpleXrm.valid(r)||simpleXrm.valid(u)||simpleXrm.valid(f))&&(t+="&"),t+=e.toString()),simpleXrm.valid(s)&&((simpleXrm.valid(i)||simpleXrm.valid(r)||simpleXrm.valid(u)||simpleXrm.valid(f)||simpleXrm.valid(e))&&(t+="&"),t+=s.toString()),t},buildFilter:function(n){return""+(n.operator==="startswith"||n.operator==="substringof"||n.operator==="endswith"?n.operator+"("+n.attribute+","+n.value+")":n.attribute+" "+n.operator+" "+n.value)},groupFiltersOr:function(){return"("+arguments.join(" or ")+")"},groupFiltersAnd:function(){return"("+arguments.join(" and ")},filter:function(){for(var t=[],n=0;n<arguments.length;n++)typeof arguments[n]=="object"?t.push(simpleXrmRest.buildFilter(arguments[n])):typeof arguments[n]=="string"&&t.push(arguments[n]);return"$filter="+simpleXrm.link(t," and ")},select:function(){return"$select="+simpleXrm.link(arguments,",")},selectFromExpanded:function(n){for(var i=[],t=1;t<arguments.length;t++)i.push(n.toString()+"/"+arguments[t].toString());return simpleXrm.link(i,",")},expand:function(){return"$expand="+simpleXrm.link(arguments,",")},orderBy:function(){return"$orderby="+simpleXrm.link(arguments,",")},skip:function(n){return"$skip="+n.toString()},top:function(n){return"$top="+n.toString()},queryLookup:function(n){var t="guid'"+simpleXrm.cleanGuid(simpleXrm.getLookupID(n.lookup.toString()))+"'",i=n.entityType+"Set",r=simpleXrmRest.buildFilter({attribute:n.entityType+"Id",operator:"eq",value:t}),u=simpleXrmRest.filter(r),f=simpleXrmRest.select(simpleXrm.link(n.attributes,","));return simpleXrmRest.buildQuery({entitySet:i,filter:u,select:f})},parseOnReady:function(n){if(n.readyState===4&&n.status===200)return JSON.parse(n.responseText).d},normalizeResults:function(n){return simpleXrmRest.getRetrieveSingleResults(n)},getRetrieveSingleResults:function(n){var t=null,i=simpleXrmRest.parseOnReady(n),r,u,f;return simpleXrm.valid(i)&&(r=i.results,u=i.result,simpleXrm.valid(r)?(f=r[0],simpleXrm.valid(f)&&(t=f)):simpleXrm.valid(u)&&(t=u)),t},getRetrieveMultipleResults:function(n){var i=null,r=simpleXrmRest.parseOnReady(n),t;return simpleXrm.valid(r)&&(t=r.results,simpleXrm.valid(t)&&(i=t)),i},setPriceListPrice:function(n){var t={product:null||simpleXrm.getLookupID(n.productLookupField),pricelist:null||simpleXrm.getLookupID(n.priceListLookupField),unitPriceField:n.unitPriceField,listPriceField:n.listPriceField,unitField:n.unitField,callback:null||n.callback};simpleXrm.valid(t.product)&&simpleXrm.valid(t.pricelist)&&simpleXrmRest.XHR({query:simpleXrmRest.buildQuery({entitySet:"ProductSet",select:"$select=CurrentCost,ProductNumber,Price,StandardCost",filter:"$filter=ProductId eq guid'"+t.product+"'"}),callback:function(){var i=simpleXrmRest.normalizeResults(this);simpleXrm.valid(i)&&(t.currentCost=i.CurrentCost.Value,typeof t.currentCost=="string"&&(t.currentCost=parseFloat(t.currentCost)),t.productNumber=i.ProductNumber,t.listPrice=i.Price.Value,typeof t.listPrice=="string"&&(t.listPrice=parseFloat(t.listPrice)),t.standardCost=i.StandardCost.Value,typeof t.standardCost=="string"&&(t.standardCost=parseFloat(t.standardCost)),simpleXrm.setAttVal(t.listPriceField,t.listPrice),simpleXrm.sendAttAlways(t.listPriceField),simpleXrmRest.XHR({query:simpleXrmRest.buildQuery({entitySet:"ProductPriceLevelSet",select:"$select=Amount,Percentage,PricingMethodCode,UoMId,RoundingOptionCode,RoundingPolicyCode,RoundingOptionAmount",filter:"$filter=(PriceLevelId/Id eq guid'"+t.pricelist+"' and ProductId/Id eq guid'"+t.product+"')"}),callback:function(){var u=simpleXrmRest.normalizeResults(this),i,f,r,e;if(u){t.amount=u.Amount.Value;typeof t.amount=="string"&&(t.amount=parseFloat(t.amount));t.percentage=u.Percentage;typeof t.percentage=="string"&&(t.percentage=parseFloat(t.percentage));t.pricingMethodCode=u.PricingMethodCode.Value;t.unit=simpleXrm.parseRESTLookup(u.UoMId);simpleXrm.setAttVal(t.unitField,t.unit);simpleXrm.sendAttAlways(t.unitField);t.roundingOptionCode=u.RoundingOptionCode.Value;t.roundingPolicyCode=u.RoundingPolicyCode.Value;t.roundingOptionAmount=u.RoundingOptionAmount;typeof t.roundingOptionAmount=="string"&&(t.roundingOptionAmount=parseFloat(t.roundingOptionAmount));i=null;f=!0;t.roundingPolicyCode==1&&(f=!1);switch(t.pricingMethodCode){case 1:i=t.amount;f=!1;break;case 2:i=t.percentage*t.listPrice/100;break;case 3:i=(t.percentage+100)*t.currentCost/100;break;case 4:i=100*t.currentCost/(100-t.percentage);break;case 5:i=(t.percentage+100)*t.standardCost/100;break;case 6:i=100*t.standardCost/(100-t.percentage);break;default:i=t.listPrice}if(f!=!0&&simpleXrm.valid(i))simpleXrm.setAttVal(n.unitPriceField,i);else if(f===!0&&simpleXrm.valid(i)){r=null;e=null;switch(t.roundingPolicyCode){case 2:t.roundingOptionCode==1?(r=10*Math.floor(i/10)+t.roundingOptionAmount,i>r&&(r+=10)):t.roundingOptionCode==2&&(r=Math.ceil(i/t.roundingOptionAmount)*t.roundingOptionAmount);break;case 3:t.roundingOptionCode==1?(r=10*Math.floor(i/10)+t.roundingOptionAmount,i<r&&(r-=10)):t.roundingOptionCode==2&&(r=Math.floor(i/t.roundingOptionAmount)*t.roundingOptionAmount);break;case 4:t.roundingOptionCode==1?(r=10*Math.floor(i/10)+t.roundingOptionAmount,i>r?e=r+10:i<r&&(r-=10,e=r+10),Math.abs(i-r)>Math.abs(i-e)&&(r=e)):t.roundingOptionCode==2&&(r=Math.round(i/t.roundingOptionAmount)*t.roundingOptionAmount)}simpleXrm.valid(r)&&(i=r)}simpleXrm.setAttVal(t.unitPriceField,i);simpleXrm.sendAttAlways(t.unitPriceField);try{t.callback()}catch(o){simpleXrm.timedFormError("The callback function could not be invoked.",3e3)}}else simpleXrm.timedFormError("The Price List Item could not be loaded.",3e3)}}))}})}},simpleXrmFetch={filter:function(n){var i="",r="",t;if(!!n){if(n.type&&!!n.conditions&&n.conditions.length>0){for(i+="<filter type='"+n.type+"'>",r+="<\/filter>",t=0;t<n.conditions.length;t++)!n.conditions[t].attribute||!n.conditions[t].operator||(i+="<condition attribute='"+n.conditions[t].attribute+"' operator='"+n.conditions[t].operator+"' ",!n.conditions[t].uiname||(i+="uiname='"+n.conditions[t].uiname+"' "),!n.conditions[t].uitype||(i+="uitype='"+n.conditions[t].uitype+"' "),!n.conditions[t].value||(i+="value='"+n.conditions[t].value+"' "),i+="/>");!n.filter||(i+=simpleXrmFetch.filter(n.filter))}return i+r}},order:function(n){var i="",t;if(!!n&&n.length>0)for(n.length>2&&(n=n.slice(0,2)),t=0;t<n.length;t++)i+="<order attribute='"+n[t].attribute+"'",i+=n[t].descending?" descending='true'":" descending='false'",i+=" />";return i},attributes:function(n){var i="",t;if(n.length>0)for(t=0;t<n.length;t++)i+="<attribute name='"+n[t].name+"'",!n[t].alias||(i+=" alias='"+n[t].alias+"'"),i+=" />";return i},linkEntity:function(n){var i="",r="",t;if(!!n&&n.length>0)for(t=0;t<n.length;t++)!n[t].name||!n[t].from||!n[t].to||(i+="<link-entity name='"+n[t].name+"' from='"+n[t].from+"' to='"+n[t].to+"'",r="<\/link-entity>"+r,n[t].visible===!1&&(i+=" visible='false'"),!n[t].intersect||(i+=" intersect='true'"),!n[t].alias||(i+=" alias='"+n[t].alias+"'"),i+=">",!!n[t].attributes&&n[t].attributes.length>0&&(i+=simpleXrmFetch.attributes(n[t].attributes)),!n[t].filter||(i+=simpleXrmFetch.filter(n[t].filter)),!n[t].linkEntity||simpleXrmFetch.linkEntity(n[t].linkEntity));return i+r},fetch:function(n){var t="<fetch version='1.0' output-format='xml-platform' mapping='logical'",i;return t+=n.distinct?" distinct='true'":" distinct='false'",t+=">",i="<\/fetch>",!n.entity||(t+="<entity name='"+n.entity+"'>",i="<\/entity>"+i),!!n.attributes&&n.attributes.length>0&&(t+=simpleXrmFetch.attributes(n.attributes)),!!n.order&&n.order.length>0&&(t+=simpleXrmFetch.order(n.order)),!n.filter||(t+=simpleXrmFetch.filter(n.filter)),!n.linkEntity||(t+=simpleXrmFetch.linkEntity(n.linkEntity)),t+i},addCustomFilter:function(n){Xrm.Page.getControl(n.control).addCustomFilter(n.filter,n.entityType)},addCustomView:function(n){var t="";t=n.viewId?simpleXrm.wrapGuid(n.viewId):simpleXrm.newBracedGuid();Xrm.Page.getControl(n.control).addCustomView(t,n.entityType,n.viewDisplayName,n.fetchXml,n.layoutXml,n.isDefault)},addPreSearch:function(n){Xrm.Page.getControl(n.control).addPreSearch(n.preSearchHandler)}},simpleXrmLayout={layout:function(n){var t="",i="";return t+="<grid",t+=n.name?" name='"+n.name+"'":" name='resultset'",t+=n.icon?" icon='1'":" icon='0'",!n.jump||(t+=" jump='"+n.jump+"'"),!n.object||(t+=" object='"+n.object.toString()+"'"),t+=n.preview?" preview='1'":" preview='0'",t+=" select='1'",t+=">",i+="<\/grid>",!n.row||(t+=simpleXrmLayout.row(n.row)),t+i},row:function(n){var t="",i="";return t+="<row ",i+="<\/row>",t+=n.name?"name='"+n.name+"' ":"name='result' ",!n.id||(t+="id='"+n.id+"'"),t+=">",!!n.cells&&n.cells.length>0&&(t+=simpleXrmLayout.cells(n.cells)),t+i},cells:function(n){var i="",t;if(n.length>0)for(t=0;t<n.length;t++)i+="<cell name='"+n[t].name+"' width='"+n[t].width.toString()+"' />";return i}},simpleXrmMaps={getRoute:function(n){for(var r,t,e=n.wayPoints[0],o=n.wayPoints[n.wayPoints.length-1],u="https://dev.virtualearth.net/REST/v1/Routes?",f=[],i=0;i<n.wayPoints.length;i++)r=n.wayPoints[i],r===e||r===o?f.push("wp."+i.toString()+"="+r.toString()):f.push("vwp."+i.toString()+"="+r.toString());if(u+=f.join("&"),u+="&key="+n.key,window.XMLHttpRequest)t=new XMLHttpRequest;else if(window.ActiveXObject)t=new ActiveXObject("Microsoft.XMLHTTP");else return simpleXrm.error("We encountered an unexpected issue. Please check your form data before proceeding. Info for Admin: User's browser may not support one of the requested scripts. Please attempt using FireFox or IE 8+"),null;"withCredentials"in t?t.open("GET",encodeURI(u),!0):typeof XDomainRequest!="undefined"?(t=new XDomainRequest,t.open("GET",encodeURI(u))):t=null;t.setRequestHeader("Accept","application/json");t.setRequestHeader("Content-Type","application/json; charset=utf-8");t.onload=n.callback;t.send()},getLocation:function(n){var t,r="https://dev.virtualearth.net/REST/v1/Locations?",i;if(n.address?r+="q="+n.address:(i=[],n.country&&i.push("CountryRegion="+n.country),n.state&&i.push("adminDistrict="+n.state),n.city&&i.push("locality="+n.city),n.zip&&i.push("postalCode="+n.zip),n.street&&i.push("addressLine="+n.street),r+=i.join("&")),r+="&key="+n.key,window.XMLHttpRequest)t=new XMLHttpRequest;else if(window.ActiveXObject)t=new ActiveXObject("Microsoft.XMLHTTP");else return simpleXrm.error("We encountered an unexpected issue. Please check your form data before proceeding. Info for Admin: User's browser may not support one of the requested scripts. Please attempt using FireFox or IE 8+"),null;"withCredentials"in t?t.open("GET",encodeURI(r),!0):typeof XDomainRequest!="undefined"?(t=new XDomainRequest,t.open("GET",encodeURI(r))):t=null;t.setRequestHeader("Accept","application/json");t.setRequestHeader("Content-Type","application/json; charset=utf-8");t.onload=n.callback;t.send()},parseOnReady:function(n){var t=!1;return n.readyState===4&&n.status===200&&(t=JSON.parse(n.responseText),t.resourceSets&&t.resourceSets[0]&&t.resourceSets[0].resources&&t.resourceSets[0].resources[0]&&(t=t.resourceSets[0].resources[0])),t}},simpleXrmSoap={request:function(n){var i=Xrm.Page.context.getClientUrl()+"/XRMServices/2011/Organization.svc/web",t;if(window.XMLHttpRequest)t=new XMLHttpRequest;else if(window.ActiveXObject)t=new ActiveXObject("Microsoft.XMLHTTP");else return simpleXrm.error("We encountered an unexpected issue. Please check your form data before proceeding. Info for Admin: User's browser may not support one of the requested scripts. Please attempt using FireFox or IE 8+"),null;t.open("POST",encodeURI(i),!1);t.setRequestHeader("Accept","application/xml, text/xml, */*");t.setRequestHeader("Content-Type","text/xml; charset=utf-8");t.setRequestHeader("SOAPAction","http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute");t.onreadystatechange=n.callback;t.send(n.request)},parseOnReady:function(n){var t=!1;return n.readyState===4&&n.status===200&&(t=!0),t},runWorkflow:function(n){var t='<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Body><Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><request xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts"><a:Parameters xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic"><a:KeyValuePairOfstringanyType><b:key>Target<\/b:key><b:value i:type="a:EntityReference"><a:Id>'+n.target.id+"<\/a:Id><a:LogicalName>"+n.target.entityName+'<\/a:LogicalName><a:Name i:nil="true" /><\/b:value><\/a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><b:key>WorkflowId/b:key><b:value i:type="d:guid" xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/">'+n.workflow.id+'<\/b:value><\/a:KeyValuePairOfstringanyType><\/a:Parameters><a:RequestId i:nil="true" /><a:RequestName>ExecuteWorkflow<\/a:RequestName><\/request><\/Execute><\/s:Body><\/s:Envelope>';simpleXrmSoap.request({request:t,callback:n.callback})}};
/*
//# sourceMappingURL=simpleXrmFull.min.js.map
*/