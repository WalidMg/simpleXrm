var simpleXrm={error:function(n,t){!t||simpleXrm.timedFormError("m",3e3);console.log("Error originating in a script using the simpleXrm.js library. Contact your CRM Administrator with the following details: Element "+n.toString()+" was not found or is invalid.")},getAttDate:function(n){var t=simpleXrm.getAttVal(n);return{year:t.getFullYear(),month:t.getMonth(),date:t.getDate(),hours:t.getHours(),minutes:t.getMinutes()}||null},parseDuration:function(n){return x=n*6e4||null},parseDate:function(n){return x=new Date(n.year,n.month,n.date,n.hours,n.minutes).getTime()||null},offsetTime:function(n,t){var i=simpleXrm.getAttVal(n)||null,r=i.getFullYear()||null,u=i.getMonth()||null,f=i.getDate()||null,e=i.getHours()||null,o=i.getMinutes()||null;return new Date(r,u,f,e+t,o)||null},valid:function(n){return n!=null&&n!=undefined},doesNotContainData:function(n){return!Xrm.Page.getAttribute(n).getValue()},containsData:function(n){return!!Xrm.Page.getAttribute(n).getValue()||!1},validAtt:function(n){return!!n&&!!Xrm.Page.getAttribute(n)||!1},getCurrentId:function(){return Xrm.Page.data.entity.getId()},getCurrentEntityName:function(){return Xrm.Page.data.entity.getEntityName()},getAtt:function(n){return Xrm.Page.getAttribute(n)||null},getAttType:function(n){return Xrm.Page.getAttribute(n).getAttributeType()||null},getAttVal:function(n){return Xrm.Page.getAttribute(n).getValue()||null},hasVal:function(n){return!!Xrm.Page.getAttribute(n).getValue()||!1},getLookupVal:function(n){return simpleXrm.getAttVal(n)?Xrm.Page.getAttribute(n).getValue()[0].name:null},getLookupID:function(n){return simpleXrm.getAttVal(n)?Xrm.Page.getAttribute(n).getValue()[0].id:null},getLookupEntityName:function(n){return simpleXrm.getAttVal(n)?Xrm.Page.getAttribute(n).getValue()[0].entityType:null},setAttVal:function(n,t){try{Xrm.Page.getAttribute(n).setValue(t)}catch(i){simpleXrm.error(n,"Could not set the value of attribute "+n+" to value "+t.toString()+".")}},clearAttVal:function(n){Xrm.Page.getAttribute(n.toString()).setValue(null);simpleXrm.sendAttAlways(n.toString())},clearAttsVal:function(){for(var n=0;n<arguments.length;n++)simpleXrm.clearAttVal(arguments[n])},sendAttAlways:function(n){simpleXrm.getAtt(n).setSubmitMode("always")},sendAttsAlways:function(){for(var n=0;n<arguments.length;n++)simpleXrm.sendAttAlways(arguments[n])},sendAttNever:function(n){simpleXrm.getAtt(n).setSubmitMode("never")},sendAttsNever:function(){for(var n=0;n<arguments.length;n++)simpleXrm.sendAttNever(arguments[n])},sendAttChanges:function(n){simpleXrm.getAtt(n).setSubmitMode("dirty")},sendAttsChanges:function(){for(var n=0;n<arguments.length;n++)simpleXrm.sendAttChanges(arguments[n])},getAttReqd:function(n){return simpleXrm.getAtt(n).getRequiredLevel()},setAttReqd:function(n){simpleXrm.getAtt(n).setRequiredLevel("required")},setAttsReqd:function(){for(var n=0;n<arguments.length;n++)simpleXrm.setAttReqd(arguments[n])},clearAttReqd:function(n){simpleXrm.getAtt(n).setRequiredLevel("none")},clearAttsReqd:function(){for(var n=0;n<arguments.length;n++)simpleXrm.clearAttReqd(arguments[n])},setAttRecommended:function(n){simpleXrm.getAtt(n).setRequiredLevel("recommended")},setAttsRecommended:function(){for(var n=0;n<arguments.length;n++)simpleXrm.setAttRecommended(arguments[n])},fireOnChange:function(n){simpleXrm.getAtt(n).fireOnChange()},fireChanges:function(){for(var n=0;n<arguments.length;n++)simpleXrm.fireOnChange(arguments[n])},validCtrl:function(n){return simpleXrm.valid(Xrm.Page.getControl(n))||!1},getCtrl:function(n){return Xrm.Page.getControl(n)},getAllCtrls:function(n){return simpleXrm.getAtt(n).controls},showCtrl:function(n){simpleXrm.getCtrl(n).setVisible(!0)},showCtrls:function(){for(var n=0;n<arguments.length;n++)simpleXrm.showCtrl(arguments[n])},hideCtrl:function(n){simpleXrm.getCtrl(n).setVisible(!1)},hideCtrls:function(){for(var n=0;n<arguments.length;n++)simpleXrm.hideCtrl(arguments[n])},clearOptions:function(n){simpleXrm.getAllCtrls(n).forEach(function(n){n.clearOptions()})},restoreOptions:function(n){simpleXrm.clearOptions(n);simpleXrm.getAllCtrls(n).forEach(function(t){simpleXrm.getAtt(n).getOptions().forEach(function(n){t.addOption(n)})})},removeOption:function(n,t){simpleXrm.getAllCtrls(n).forEach(function(n){n.removeOption(t)})},showAllCtrls:function(n){simpleXrm.getAllCtrls(n).forEach(function(n){n.setVisible(!0)})},hideAllCtrls:function(n){simpleXrm.getAllCtrls(n).forEach(function(n){n.setVisible(!1)})},lockCtrl:function(n){simpleXrm.getCtrl(n).setDisabled(!0)},lockCtrls:function(){for(var n=0;n<arguments.length;n++)simpleXrm.lockCtrl(arguments[n])},unlockCtrl:function(n){simpleXrm.getCtrl(n).setDisabled(!1)},unlockCtrls:function(){for(var n=0;n<arguments.length;n++)simpleXrm.unlockCtrl(arguments[n])},lockAllCtrls:function(n){simpleXrm.getAllCtrls(n).forEach(function(n){n.setDisabled(!0)})},unlockAllCtrls:function(n){simpleXrm.getAllCtrls(n).forEach(function(n){n.setDisabled(!1)})},relabelCtrl:function(n,t){simpleXrm.getCtrl(n).setLabel(t)},relabelAllCtrls:function(n,t){simpleXrm.getAllCtrls(n).forEach(function(n){n.setLabel(t)})},allTabs:function(){return Xrm.Page.ui.tabs},validTab:function(n){return!!simpleXrm.allTabs().get(n)||!1},getTab:function(n){return simpleXrm.allTabs().get(n.toString())},showTab:function(n){simpleXrm.getTab(n).setVisible(!0)},showTabs:function(){for(var n=0;n<arguments.length;n++)simpleXrm.showTab(arguments[n])},hideTab:function(n){simpleXrm.getTab(n).setVisible(!1)},hideTabs:function(){for(var n=0;n<arguments.length;n++)simpleXrm.hideTab(arguments[n])},validSection:function(n){var t=!1;return simpleXrm.allTabs().forEach(function(i){!i.sections.get(n.toString())||(t=!0)}),t},getSection:function(n){var t=null;return simpleXrm.allTabs().forEach(function(i){simpleXrm.valid(i.sections.get(n.toString()))&&(t=i.sections.get(n.toString()))}),t},showSection:function(n){simpleXrm.getSection(n).setVisible(!0)},showSections:function(){for(var n=0;n<arguments.length;n++)simpleXrm.showSection(arguments[n])},hideSection:function(n){simpleXrm.getSection(n).setVisible(!1)},hideSections:function(){for(var n=0;n<arguments.length;n++)simpleXrm.hideSection(arguments[n])},closeAtt:function(n){simpleXrm.hideAllCtrls(n);simpleXrm.clearAttReqd(n);simpleXrm.clearAttVal(n);simpleXrm.lockAllCtrls(n);simpleXrm.sendAttChanges(n)},closeAtts:function(){for(var n=0;n<arguments.length;n++)simpleXrm.closeAtt(arguments[n])},openAtt:function(n){simpleXrm.unlockAllCtrls(n);simpleXrm.showAllCtrls(n);simpleXrm.sendAttChanges(n)},openAtts:function(){for(var n=0;n<arguments.length;n++)simpleXrm.openAtt(arguments[n])},sumAtts:function(){for(var t=0,n=0;n<arguments.length;n++)isNaN(simpleXrm.getAttVal(arguments[n]))||(t+=simpleXrm.getAttVal(arguments[n]));return t},calculatePercent:function(n,t){return n/t*100},link:function(n,t){return n.length===1?n[0].toString():n.join(t)},newGuid:function(){function n(){return((1+Math.random())*65536|0).toString(16).substring(1)}return(n()+n()+"-"+n()+"-4"+n().substr(0,3)+"-"+n()+"-"+n()+n()+n()).toString()},newBracedGuid:function(){return"{"+simpleXrm.newGuid()+"}"},cleanGuid:function(n){try{return n.replace("{","").replace("}","")}catch(t){return null}},wrapGuid:function(n){try{return"{"+simpleXrm.cleanGuid(n)+"}"}catch(t){return null}},timeStamp:function(n,i){if(t=Xrm.Page.getAttribute(n).getValue(),t===null||i===!0||i===undefined){var r=new Date;Xrm.Page.getAttribute(n).setValue(r);Xrm.Page.getAttribute(n).setSubmitMode("dirty")}},parseRESTLookup:function(n){try{return[{entityType:n.LogicalName,id:simpleXrm.wrapGuid(n.Id),name:n.Name}]}catch(i){return null}},setLookupVal:function(n,t,i){var u=t||null,r=!0;i===!1&&(r=!1);r&&simpleXrm.setAttVal(n,u)},setBooleanDefault:function(n){simpleXrm.getAttVal(n)||simpleXrm.setAttVal(n,!1)},setBooleanDefaults:function(){for(var n=0;n<arguments.length;n++)simpleXrm.setBooleanDefault(arguments[n])},applyFilter:function(n){simpleXrm.getCtrl(n).addPreSearch(function(t){simpleXrm.getCtrl(n).addCustomFilter(t)})},closeSection:function(n){simpleXrm.hideSection(n);simpleXrm.getSection(n).controls.forEach(function(n){n.getAttribute().setValue(null);n.getAttribute().setSubmitMode("dirty");n.setRequiredLevel("none");n.setDisabled(!0)})},closeSections:function(){for(var n=0;n<arguments.length;n++)simpleXrm.closeSection(arguments[n])},closeTab:function(n){simpleXrm.hideTab(n);simpleXrm.getTab(n).sections.forEach(function(n){n.controls.forEach(function(n){n.getAttribute().setValue(null)})})},closeTabs:function(){for(var n=0;n<arguments.length;n++)simpleXrm.closeTab(arguments[n])},formatPhoneNumber:function(n){var i=n.getEventSource(),r=function(n){for(var i,t,u="",r=0;r<n.length;r++){i=n.charAt(r).toUpperCase();t=i;switch(i){case"A":case"B":case"C":t=2;break;case"D":case"E":case"F":t=3;break;case"G":case"H":case"I":t=4;break;case"J":case"K":case"L":t=5;break;case"M":case"N":case"O":t=6;break;case"P":case"Q":case"R":case"S":t=7;break;case"T":case"U":case"V":t=8;break;case"W":case"X":case"Y":case"Z":t=9;break;default:t=i}u+=t}return u},t;if(simpleXrm.valid(i)&&i.getValue()!=null){t=i.getValue().replace(/[^0-9,A-Z,a-z]/g,"");try{t=t.length<=10?r(t):r(t.substr(0,10))+t.substr(10,t.length)}catch(u){}switch(t.length){case 1:case 2:case 3:case 4:case 5:case 6:case 8:case 9:break;case 7:i.setValue(t.substr(0,3)+"-"+t.substr(3,4));break;case 10:i.setValue("("+t.substr(0,3)+") "+t.substr(3,3)+"-"+t.substr(6,4));break;default:i.setValue("("+t.substr(0,3)+") "+t.substr(3,3)+"-"+t.substr(6,4)+" "+t.substr(10,t.length))}}},refresh:function(n){Xrm.Page.data.refresh(n)},setFormWarning:function(n,t){Xrm.Page.ui.setFormNotification(n,"WARNING",t)},setFormError:function(n,t){Xrm.Page.ui.setFormNotification(n,"ERROR",t)},setFormInfo:function(n,t){Xrm.Page.ui.setFormNotification(n,"INFO",t)},clearFormNotification:function(n){Xrm.Page.ui.clearFormNotification(n)},setFieldWarning:function(n,t,i){simpleXrm.getCtrl(n).setNotification(t,i)},clearFieldWarning:function(n,t){try{simpleXrm.getCtrl(n).clearNotification(t)}catch(i){console.log("Could not clear form notification with ID "+t+".")}},timedFormError:function(n,t){var i=simpleXrm.newGuid();simpleXrm.setFormError(n,i);setTimeout(function(){simpleXrm.clearFormNotification(i)},t)},timedFormWarning:function(n,t){var i=simpleXrm.newGuid();simpleXrm.setFormWarning(n,i);setTimeout(function(){simpleXrm.clearFormNotification(i)},t)},timedFormInfo:function(n,t){var i=simpleXrm.newGuid();simpleXrm.setFormInfo(n,i);setTimeout(function(){simpleXrm.clearFormNotification(i)},t)},confirmPopUp:function(n,t,i){Xrm.Utility.confirmDialog(n,t,i)},calc2Fields:function(n,t,i){var u=simpleXrm.getAttVal(n),f=simpleXrm.getAttVal(t),r=i||100;simpleXrm.valid(u)?u<=r&&u>=0?simpleXrm.setAttVal(t,r-u):u>r&&(simpleXrm.setAttVal(n,r),simpleXrm.setAttVal(t,0)):simpleXrm.valid(f)&&(f<=r&&f>=0?simpleXrm.setAttVal(n,s-f):f>r&&simpleXrm.setAttVal(t,r))},calc3Fields:function(n,t,i,r){var u=simpleXrm.getAttVal(n),e=simpleXrm.getAttVal(t),o=simpleXrm.getAttVal(i),f=r||100;simpleXrm.valid(u)||simpleXrm.setAttVal(n,0);simpleXrm.valid(e)||simpleXrm.setAttVal(t,0);simpleXrm.valid(o)||simpleXrm.setAttVal(i,0);u>=f?(simpleXrm.setAttVal(n,f),simpleXrm.setAttVal(t,0),simpleXrm.setAttVal(i,0)):u<f&&u>=0&&e<=f&&e>=0&&u+e>f?(simpleXrm.setAttVal(t,f-u),simpleXrm.setAttVal(i,0)):u<=f&&u>=0&&e<=f&&e>=0&&u+e<=f&&simpleXrm.setAttVal(i,f-(u+e))},calc4Fields:function(n,t,i,r,u){var e=simpleXrm.getAttVal(n),o=simpleXrm.getAttVal(t),s=simpleXrm.getAttVal(i),h=simpleXrm.getAttVal(r),f=u||100;simpleXrm.valid(e)||simpleXrm.setAttVal(n,0);simpleXrm.valid(o)||simpleXrm.setAttVal(t,0);simpleXrm.valid(s)||simpleXrm.setAttVal(i,0);simpleXrm.valid(h)||simpleXrm.setAttVal(r,0);e>=f?(simpleXrm.setAttVal(n,f),simpleXrm.setAttVal(t,0),simpleXrm.setAttVal(i,0),simpleXrm.setAttVal(r,0)):e<f&&e>=0&&o<=f&&o>=0&&e+o>f?(simpleXrm.setAttVal(t,f-e),simpleXrm.setAttVal(i,0),simpleXrm.setAttVal(r,0)):e<f&&e>=0&&o<=f&&o>=0&&e+o<=f&&f==0?(simpleXrm.setAttVal(i,f-(e+o)),simpleXrm.setAttVal(r,0)):e<f&&e>=0&&o<=f&&o>=0&&s<=f&&s>=0&&e+o+s<=f&&simpleXrm.setAttVal(r,f-(e+o+s))},getSaveMode:function(n){return n.getEventArgs().getSaveMode()},preventDefault:function(n){n.getEventArgs().preventDefault()},refresh:function(n){n?Xrm.Page.data.refresh(!0).then(simpleXrm.timedFormInfo("The form is being saved...",2e3)):Xrm.Page.data.refresh(!1)},backgroundSave:function(){Xrm.Page.data.save().then(simpleXrm.timedFormInfo("The form is being saved...",2e3))}};
//# sourceMappingURL=simpleXrm.min.js.map
