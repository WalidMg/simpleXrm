var simpleXrm={};simpleXrm.error=function(n,t){simpleXrm.valid(t.toString())&&Xrm.Utility.alertDialog(t.toString());console.log("Error: Oops! Something went wrong with a script. Contact your CRM Administrator with the following details: Element "+n.toString()+" was not found or is invalid.");throw new Error("Error: Oops! Something went wrong with a script. Contact your CRM Administrator with the following details: Element "+n.toString()+" was not found or is invalid.");};simpleXrm.getAttDate=function(n){if(simpleXrm.valid(n)&&simpleXrm.hasVal(n)){var t=simpleXrm.getAttVal(n);return{year:t.getFullYear(),month:t.getMonth(),date:t.getDate(),hours:t.getHours(),minutes:t.getMinutes()}}};simpleXrm.offsetTime=function(n,t){var i=simpleXrm.getAttVal(n),r=i.getFullYear(),u=i.getMonth(),f=i.getDate(),e=i.getHours(),o=i.getMinutes();return new Date(r,u,f,e+t,o)};simpleXrm.valid=function(n){return n!=null&&n!=undefined};simpleXrm.doesNotContainData=function(n){if(simpleXrm.valid(Xrm.Page.getAttribute(n.toString()))&&Xrm.Page.getAttribute(n.toString()).getValue()===null)return!0;if(simpleXrm.valid(Xrm.Page.getAttribute(n.toString()))&&Xrm.Page.getAttribute(n.toString()).getValue()!=null)return!1;simpleXrm.error(n)};simpleXrm.containsData=function(n){return!simpleXrm.doesNotContainData(n)};simpleXrm.validAtt=function(n){return simpleXrm.valid(Xrm.Page.getAttribute(n.toString()))};simpleXrm.getAtt=function(n){if(simpleXrm.validAtt(n))return Xrm.Page.getAttribute(n.toString());simpleXrm.error(n)};simpleXrm.getAttType=function(n){if(simpleXrm.validAtt(n))return Xrm.Page.getAttribute(n.toString()).getAttributeType();simpleXrm.error(n)};simpleXrm.getAttVal=function(n){if(simpleXrm.validAtt(n))return Xrm.Page.getAttribute(n.toString()).getValue();simpleXrm.error(n)};simpleXrm.hasVal=function(n){if(simpleXrm.validAtt(n))return simpleXrm.valid(Xrm.Page.getAttribute(n.toString()).getValue());simpleXrm.error(n)};simpleXrm.getLookupVal=function(n){if(simpleXrm.hasVal(n))return Xrm.Page.getAttribute(n.toString()).getValue()[0].name;if(simpleXrm.validAtt(n))return null;simpleXrm.error(n)};simpleXrm.getLookupID=function(n){if(simpleXrm.hasVal(n))return Xrm.Page.getAttribute(n.toString()).getValue()[0].id;if(simpleXrm.validAtt(n))return null;simpleXrm.error(n)};simpleXrm.getLookupEntityName=function(n){if(simpleXrm.hasVal(n))return Xrm.Page.getAttribute(n.toString()).getValue()[0].entityType;if(simpleXrm.validAtt(n))return null;simpleXrm.error(n)};simpleXrm.setAttVal=function(n,t){simpleXrm.validAtt(n)&&simpleXrm.valid(t)?(Xrm.Page.getAttribute(n.toString()).setValue(t),simpleXrm.sendAttAlways(n.toString())):simpleXrm.validAtt(n)?simpleXrm.error(t):simpleXrm.error(n)};simpleXrm.clearAttVal=function(n){simpleXrm.validAtt(n)?(Xrm.Page.getAttribute(n.toString()).setValue(null),simpleXrm.sendAttAlways(n.toString())):simpleXrm.error(n)};simpleXrm.clearAttsVal=function(){for(i=0;i<arguments.length;i++)simpleXrm.clearAttVal(arguments[i])};simpleXrm.sendAttAlways=function(n){simpleXrm.getAtt(n).setSubmitMode("always")};simpleXrm.sendAttsAlways=function(){for(i=0;i<arguments.length;i++)simpleXrm.sendAttAlways(arguments[i])};simpleXrm.sendAttNever=function(n){simpleXrm.getAtt(n).setSubmitMode("never")};simpleXrm.sendAttsNever=function(){for(i=0;i<arguments.length;i++)simpleXrm.sendAttNever(arguments[i])};simpleXrm.sendAttChanges=function(n){simpleXrm.getAtt(n).setSubmitMode("dirty")};simpleXrm.sendAttsChanges=function(){for(i=0;i<arguments.length;i++)simpleXrm.sendAttChanges(arguments[i])};simpleXrm.getAttReqd=function(n){return simpleXrm.getAtt(n).getRequiredLevel()};simpleXrm.setAttReqd=function(n){simpleXrm.getAtt(n).setRequiredLevel("required")};simpleXrm.setAttsReqd=function(){for(i=0;i<arguments.length;i++)simpleXrm.setAttReqd(arguments[i])};simpleXrm.clearAttReqd=function(n){simpleXrm.getAtt(n).setRequiredLevel("none")};simpleXrm.clearAttsReqd=function(){for(i=0;i<arguments.length;i++)simpleXrm.clearAttReqd(arguments[i])};simpleXrm.setAttRecommended=function(n){simpleXrm.getAtt(n).setRequiredLevel("recommended")};simpleXrm.setAttsRecommended=function(){for(i=0;i<arguments.length;i++)simpleXrm.setAttRecommended(arguments[i])};simpleXrm.fireOnChange=function(n){simpleXrm.validAtt(n)?simpleXrm.getAtt(n).fireOnChange():simpleXrm.error(n)};simpleXrm.fireChanges=function(){for(i=0;i<arguments.length;i++)simpleXrm.fireOnChange(arguments[i])};simpleXrm.validCtrl=function(n){if(simpleXrm.valid(n))return simpleXrm.valid(Xrm.Page.getControl(n.toString()));simpleXrm.error(n)};simpleXrm.getCtrl=function(n){if(simpleXrm.validCtrl(n))return Xrm.Page.getControl(n.toString());simpleXrm.error(n)};simpleXrm.getAllCtrls=function(n){return simpleXrm.getAtt(n).controls};simpleXrm.showCtrl=function(n){simpleXrm.valid(simpleXrm.getCtrl(n))&&simpleXrm.getCtrl(n).setVisible(!0)};simpleXrm.showCtrls=function(){for(i=0;i<arguments.length;i++)simpleXrm.showCtrl(arguments[i])};simpleXrm.hideCtrl=function(n){simpleXrm.valid(simpleXrm.getCtrl(n))&&simpleXrm.getCtrl(n).setVisible(!1)};simpleXrm.hideCtrls=function(){for(i=0;i<arguments.length;i++)simpleXrm.hideCtrl(arguments[i])};simpleXrm.clearOptions=function(n){simpleXrm.getAllCtrls(n).forEach(function(n){n.clearOptions()})};simpleXrm.restoreOptions=function(n){simpleXrm.clearOptions(n);var t=simpleXrm.getAtt(n).getOptions();simpleXrm.getAllCtrls(n).forEach(function(n){t.forEach(function(t){n.addOption(t)})})};simpleXrm.removeOption=function(n,t){simpleXrm.getAllCtrls(n).forEach(function(n){n.removeOption(t)})};simpleXrm.showAllCtrls=function(n){simpleXrm.valid(simpleXrm.getAllCtrls(n))&&simpleXrm.getAllCtrls(n).forEach(function(n){n.setVisible(!0)})};simpleXrm.hideAllCtrls=function(n){simpleXrm.valid(simpleXrm.getAllCtrls(n))&&simpleXrm.getAllCtrls(n).forEach(function(n){n.setVisible(!1)})};simpleXrm.lockCtrl=function(n){simpleXrm.getCtrl(n).setDisabled(!0)};simpleXrm.lockCtrls=function(){for(i=0;i<arguments.length;i++)simpleXrm.lockCtrl(arguments[i])};simpleXrm.unlockCtrl=function(n){simpleXrm.getCtrl(n).setDisabled(!1)};simpleXrm.unlockCtrls=function(){for(i=0;i<arguments.length;i++)simpleXrm.unlockCtrl(arguments[i])};simpleXrm.lockAllCtrls=function(n){simpleXrm.valid(simpleXrm.getAllCtrls(n))&&simpleXrm.getAllCtrls(n).forEach(function(n){n.setDisabled(!0)})};simpleXrm.unlockAllCtrls=function(n){simpleXrm.valid(simpleXrm.getAllCtrls(n))&&simpleXrm.getAllCtrls(n).forEach(function(n){n.setDisabled(!1)})};simpleXrm.relabelCtrl=function(n,t){simpleXrm.getCtrl(n).setLabel(t)};simpleXrm.relabelAllCtrls=function(n,t){simpleXrm.valid(simpleXrm.getAllCtrls(n))&&simpleXrm.getAllCtrls(n).forEach(function(n){n.setLabel(t)})};simpleXrm.allTabs=function(){return Xrm.Page.ui.tabs};simpleXrm.validTab=function(n){return simpleXrm.valid(simpleXrm.allTabs().get(n.toString()))};simpleXrm.getTab=function(n){return simpleXrm.allTabs().get(n.toString())};simpleXrm.showTab=function(n){simpleXrm.getTab(n).setVisible(!0)};simpleXrm.showTabs=function(){for(i=0;i<arguments.length;i++)simpleXrm.showTab(arguments[i])};simpleXrm.hideTab=function(n){simpleXrm.getTab(n).setVisible(!1)};simpleXrm.hideTabs=function(){for(i=0;i<arguments.length;i++)simpleXrm.hideTab(arguments[i])};simpleXrm.validSection=function(n){simpleXrm.allTabs().forEach(function(t){if(simpleXrm.valid(t.sections.get(n.toString())))return!0})};simpleXrm.getSection=function(n){var t;return simpleXrm.allTabs().forEach(function(i){simpleXrm.valid(i.sections.get(n.toString()))&&(t=i.sections.get(n.toString()))}),t};simpleXrm.showSection=function(n){simpleXrm.getSection(n).setVisible(!0)};simpleXrm.showSections=function(){for(i=0;i<arguments.length;i++)simpleXrm.showSection(arguments[i])};simpleXrm.hideSection=function(n){simpleXrm.getSection(n).setVisible(!1)};simpleXrm.hideSections=function(){for(i=0;i<arguments.length;i++)simpleXrm.hideSection(arguments[i])};simpleXrm.closeAtt=function(n){simpleXrm.hideAllCtrls(n);simpleXrm.clearAttReqd(n);simpleXrm.clearAttVal(n);simpleXrm.lockAllCtrls(n);simpleXrm.sendAttAlways(n)};simpleXrm.closeAtts=function(){for(i=0;i<arguments.length;i++)simpleXrm.closeAtt(arguments[i])};simpleXrm.openAtt=function(n){simpleXrm.unlockAllCtrls(n);simpleXrm.showAllCtrls(n);simpleXrm.sendAttAlways(n)};simpleXrm.openAtts=function(){for(i=0;i<arguments.length;i++)simpleXrm.openAtt(arguments[i])};simpleXrm.sumAtts=function(){var n=0;for(i=0;i<arguments.length;i++)isNaN(simpleXrm.getAttVal(arguments[i]))||(n+=simpleXrm.getAttVal(arguments[i]));return n};simpleXrm.calculatePercent=function(n,t){return n/t*100};simpleXrm.link=function(n,t){return n.length===1?n[0].toString():n.join(t)};simpleXrm.newGuid=function(){function n(){return((1+Math.random())*65536|0).toString(16).substring(1)}var t=(n()+n()+"-"+n()+"-4"+n().substr(0,3)+"-"+n()+"-"+n()+n()+n()).toString();return n};simpleXrm.newBracedGuid=function(){return"{"+newGuid()+"}"};simpleXrm.cleanGuid=function(n){return n.replace("{","").replace("}","")};simpleXrm.wrapGuid=function(n){return"{"+simpleXrm.cleanGuid(n)+"}"};simpleXrm.timeStamp=function(n,i){if(t=Xrm.Page.getAttribute(n).getValue(),t===null||i===!0||i===undefined){var r=new Date;Xrm.Page.getAttribute(n).setValue(r);Xrm.Page.getAttribute(n).setSubmitMode("always")}f};simpleXrm.parseRESTLookup=function(n){var t=[];return simpleXrm.valid(n)&&(t[0]={entityType:n.LogicalName,id:simpleXrm.wrapGuid(n.Id),name:n.Name}),t};simpleXrm.setLookupVal=function(n,t,i){simpleXrm.valid(t)&&(i!=!0||!simpleXrm.hasVal(n))?simpleXrm.setAttVal(n,t):i!=!0&&simpleXrm.hasVal(n)||simpleXrm.clearAttVal(n)};simpleXrm.setBooleanDefault=function(n){simpleXrm.getAttVal(n)!==!0&&simpleXrm.setAttVal(n,!1)};simpleXrm.setBooleanDefaults=function(){for(i=0;i<arguments.length;i++)simpleXrm.setBooleanDefault(arguments[i])};simpleXrm.applyFilter=function(n){var t=simpleXrm.getCtrl(n),i=function(n){t.addCustomFilter(n)};t.addPreSearch(i)};simpleXrm.closeSection=function(n){simpleXrm.hideSection(n);simpleXrm.getSection(n).controls.forEach(function(n){simpleXrm.clearAttVal(n.getAttribute())})};simpleXrm.closeSections=function(){for(i=0;i<arguments.length;i++)simpleXrm.closeSection(arguments[i])};simpleXrm.closeTab=function(n){simpleXrm.hideTab(n);simpleXrm.getTab(n).sections.forEach(function(n){simpleXrm.closeSection(n)})};simpleXrm.closeTabs=function(){for(i=0;i<arguments.length;i++)simpleXrm.closeTab(arguments[i])};simpleXrm.formatPhoneNumber=function(n){var i=n.getEventSource(),t;if(simpleXrm.valid(i)&&i.getValue()!=null){t=i.getValue().replace(/[^0-9,A-Z,a-z]/g,"");try{t=t.length<=10?simpleXrm.mapPhoneAlpha(t):simpleXrm.mapPhoneAlpha(t.substr(0,10))+t.substr(10,t.length)}catch(r){}switch(t.length){case 1:case 2:case 3:case 4:case 5:case 6:case 8:case 9:break;case 7:i.setValue(t.substr(0,3)+"-"+t.substr(3,4));break;case 10:i.setValue("("+t.substr(0,3)+") "+t.substr(3,3)+"-"+t.substr(6,4));break;default:i.setValue("("+t.substr(0,3)+") "+t.substr(3,3)+"-"+t.substr(6,4)+" "+t.substr(10,t.length))}}};simpleXrm.mapPhoneAlpha=function(n){for(var i,t,u="",r=0;r<n.length;r++){i=n.charAt(r).toUpperCase();t=i;switch(i){case"A":case"B":case"C":t=2;break;case"D":case"E":case"F":t=3;break;case"G":case"H":case"I":t=4;break;case"J":case"K":case"L":t=5;break;case"M":case"N":case"O":t=6;break;case"P":case"Q":case"R":case"S":t=7;break;case"T":case"U":case"V":t=8;break;case"W":case"X":case"Y":case"Z":t=9;break;default:t=i}u+=t}return u};